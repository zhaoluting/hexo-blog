---
title: githooks
date: 2022-02-21 15:21:40
tags:
  - tool
  - git
categories: å·¥å…·
---

æœ€è¿‘å‘ç°äº†[githooks](https://git-scm.com/docs/githooks)è¿™ä¸ªå®è—ï¼Œå‰ç«¯å¯¹hookåº”è¯¥éƒ½ä¸é™Œç”Ÿï¼Œå°±æ˜¯é’©å­ã€‚githookså°±æ˜¯åœ¨ç‰¹å®šåŠ¨ä½œå‘ç”Ÿæ—¶è§¦å‘è‡ªå®šä¹‰è„šæœ¬ã€‚å¾ˆå¤šå‰ç«¯é¡¹ç›®éƒ½ä¼šé‡‡ç”¨Huskyåœ¨ä»£ç æäº¤å‰è¿›è¡ŒLintæ ¡éªŒå’Œcommitæäº¤æ ¡éªŒã€‚æƒ³èµ·æ¥æ›¾ç»å†™è¿‡[ã€Šå¸¸è§„eslinté…ç½®ã€‹](/tool-eslint/)å’Œ[ã€Šgit commitè¾…åŠ©å·¥å…·ã€‹](/tool-git-commit)ï¼Œæ–‡ç« æåˆ°çš„æ–¹æ¡ˆåªèƒ½é å¼€å‘è‡ªè§‰éµå®ˆï¼Œä½†æ˜¯æœ‰äº†è¿™ä¸ªgithookså°±èƒ½ç”¨ä¸€äº›ç›¸å¯¹æ¯”è¾ƒå¼ºç¡¬çš„æ‰‹æ®µã€‚å½“ç„¶ï¼Œæƒ³è¦æ›´åŠ å¼ºç¡¬çš„è¯ç”šè‡³å¯ä»¥æŠŠæ ¡éªŒæ”¾åœ¨éƒ¨ç½²é‚£å—ã€‚

<!--more-->

## githooksåˆ†ç±»
githookså¯åˆ†ä¸ºå®¢æˆ·ç«¯hookså’ŒæœåŠ¡ç«¯hooksã€‚hookså¤ªå¤šäº†ï¼Œå°±æŒ‘ä¸€äº›å¸¸ç”¨çš„ä»‹ç»ä¸‹ï¼Œå…¶ä»–çš„çœ‹[å®˜ç½‘](https://git-scm.com/docs/githooks)ã€‚

> `pre-`å‰ç¼€ä»£è¡¨å³å°†å‘ç”Ÿï¼Œé€šå¸¸ç”¨äºæ£€æŸ¥ï¼›`post-`å‰ç¼€ä»£è¡¨å·²ç»“æŸï¼Œé€šå¸¸ç”¨äºé€šçŸ¥ã€‚

### å®¢æˆ·ç«¯Hooks
å®¢æˆ·ç«¯Hookså¯åˆ†ä¸ºæäº¤å·¥ä½œæµã€E-mailå·¥ä½œæµå’Œå…¶ä»–å·¥ä½œæµã€‚E-mailå·¥ä½œæµåŸºæœ¬ç”¨ä¸åˆ°ï¼Œæ‰€ä»¥è·³è¿‡ã€‚

#### æäº¤å·¥ä½œæµ
å…³äº`git commit`çš„æœ‰å››ä¸ªæŒ‚é’©ï¼Œè§¦å‘é¡ºåºä¸ºï¼špre-commitã€prepare-commit-msgã€commit-msgã€post-commitã€‚

- **pre-commit**ï¼šåœ¨å¡«å†™æäº¤ä¿¡æ¯å’Œç”Ÿæˆæäº¤å¯¹è±¡ä¹‹å‰æ‰§è¡Œã€‚å¯ä»¥ç”¨æ¥åšåˆæ­¥çš„code reviewï¼Œæ£€æŸ¥ä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒã€è‡ªåŠ¨åŒ–æµ‹è¯•ç­‰ã€‚
- **prepare-commit-msg**ï¼šæäº¤ä¿¡æ¯æ˜¾ç¤ºä¹‹å‰ï¼Œé»˜è®¤ä¿¡æ¯è¢«åˆ›å»ºä¹‹åè°ƒç”¨ã€‚å¯ä»¥ç»“åˆæäº¤æ¨¡æ¿ï¼Œä¸ºåˆå¹¶æäº¤ã€å‹ç¼©æäº¤ã€ä¿®è®¢æäº¤ç­‰è¿™ç±»ä¼šè‡ªåŠ¨äº§ç”Ÿé»˜è®¤ä¿¡æ¯çš„æäº¤ï¼ŒåŠ¨æ€åœ°æ’å…¥ä¿¡æ¯ã€‚
- **commit-msg**ï¼šåœ¨ç”¨æˆ·è¾“å…¥æäº¤ä¿¡æ¯ä¹‹åè°ƒç”¨ã€‚å¯ä»¥ç”¨æ¥æ£€æŸ¥æäº¤ä¿¡æ¯æ˜¯å¦ç¬¦åˆè§„èŒƒã€‚
- **post-commit**ï¼šåœ¨æ•´ä¸ªæäº¤è¿‡ç¨‹å®Œæˆåè°ƒç”¨ã€‚é€šå¸¸ç”¨æ¥æç¤ºä¸€äº›ä¿¡æ¯ã€‚

#### å…¶ä»–å·¥ä½œæµ
- **pre-rebase**ï¼šåœ¨`git rebase`æ‰§è¡Œä¹‹å‰è°ƒç”¨ã€‚å¯ä»¥ç”¨æ¥è§„èŒƒrebaseæ“ä½œï¼Œå»ºè®®é˜…è¯»`.git/hooks/pre-rebase.sample`ä¸­çš„ä»£ç ã€‚
- **post-checkout**ï¼š`git checkout`æ‰§è¡Œå®Œæˆåè°ƒç”¨ã€‚å¯ä»¥ç”¨æ¥æ¸…ç†ä¸€äº›ä¸è¢«gitè¿½è¸ªçš„ä¸´æ—¶æ–‡ä»¶ã€‚
- **post-merge**ï¼š`git merge`æ‰§è¡Œå®Œæˆåè°ƒç”¨ã€‚å¯ä»¥ç”¨æ¥æ¢å¤Gitæ— æ³•è·Ÿè¸ªçš„å·¥ä½œåŒºæ•°æ®ã€‚
- **pre-push**ï¼š`git push`ä¹‹å‰è°ƒç”¨ï¼Œå¯ä»¥åœ¨æ¨é€ä¹‹å‰éªŒè¯å¯¹å¼•ç”¨çš„æ›´æ–°æ“ä½œã€‚

### æœåŠ¡å™¨ç«¯Hooks
- **pre-receive**ï¼šå¤„ç†æ¥è‡ªå®¢æˆ·ç«¯çš„æ¨é€æ“ä½œæ—¶æœ€å…ˆè¢«è°ƒç”¨ã€‚å¯ä»¥ç”¨æ¥é˜»æ­¢å¯¹å¼•ç”¨è¿›è¡Œéå¿«è¿›ï¼ˆnon-fast-forwardï¼‰çš„æ›´æ–°ï¼Œæˆ–å¯¹è¯¥æ¨é€ä¿®æ”¹çš„æ‰€æœ‰å¼•ç”¨å’Œæ–‡ä»¶è¿›è¡Œè®¿é—®æ§åˆ¶ã€‚
- **update**ï¼šåœ¨pre-receiveä¹‹åè°ƒç”¨ï¼Œä¸”ä¸pre-receiveç±»ä¼¼ï¼ŒåŒºåˆ«æ˜¯å®ƒä¼šä¸ºæ¨é€è€…æ›´æ–°çš„æ¯ä¸€ä¸ªåˆ†æ”¯è¿è¡Œä¸€æ¬¡ã€‚
- **post-receive**ï¼šåœ¨æˆåŠŸæ¨é€ä¹‹åè°ƒç”¨ã€‚å¯ä»¥ç”¨æ¥å‘é‚®ä»¶ã€é€šçŸ¥æŒç»­é›†æˆçš„æœåŠ¡å™¨ã€æ›´æ–°issuesç­‰ç­‰ã€‚

## ç®€å•å°è¯•
æ¯ä¸ªgitä»“åº“ä¸‹éƒ½æœ‰ä¸ªå¾ˆæ ¸å¿ƒçš„`.git`æ–‡ä»¶å¤¹ï¼Œå› ä¸º`.git`é‡Œçš„ä¿¡æ¯æ¯”è¾ƒæ•æ„Ÿï¼Œæ‰€ä»¥gitä¸ä¼šå°†å®ƒä¸Šä¼ åˆ°è¿œç¨‹ä»“åº“ï¼Œvscodeé»˜è®¤ä¹Ÿæ˜¯éšè—çš„ã€‚`.git/hooks`ç›®å½•ä¸‹å­˜å‚¨çš„å°±æ˜¯å„ç§hooksï¼Œæ–‡ä»¶åå°±å¯¹åº”ç€ä¸åŒçš„é’©å­ï¼Œåœ¨æ‰§è¡Œç‰¹å®šå‘½ä»¤æ—¶å°±ä¼šè°ƒç”¨è¿™äº›è„šæœ¬ï¼Œå…¶ä¸­`.sample`åç¼€çš„å°±æ˜¯å®˜ç½‘æ ·ä¾‹ã€‚

1. å¯ä»¥åœ¨vscodeçš„è®¾ç½®ä¸­ä¿®æ”¹å·¥ä½œåŒºé…ç½®(`.vscode/settings.json`)ï¼Œæ˜¾ç¤ºå‡º`.git/hooks`æ–‡ä»¶å¤¹ã€‚
```json
{
  "files.exclude": {
    "**/.git": false,
    "**/.git/{objects,[!hooks]*}": true,
  }
}
```

2. é¡¹ç›®æ ¹ç›®å½•æ–°å»ºä¸€ä¸ª`.githooks`æ–‡ä»¶å¤¹ï¼Œæ­¤æ–‡ä»¶å¤¹ä¸‹æ–°å»º`post-checkout`æ–‡ä»¶ï¼Œå¹¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š
```sh
#!/bin/bash
curBranch=`git branch | grep "*"`
echo -e "# å½“å‰åˆ†æ”¯ï¼š${curBranch:2} \n# å½“å‰commitï¼š${2}"
```

3. å¦‚æœgitç‰ˆæœ¬åœ¨2.9ä»¥ä¸Šï¼Œå¯ä»¥æ‰‹åŠ¨é…ç½®githooksæ‰€åœ¨çš„ç›®å½•ï¼Œåœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹æ‰§è¡Œï¼š
```sh
git config core.hooksPath .githooks
```
  å¦‚æœgitç‰ˆæœ¬åœ¨2.9ä»¥ä¸‹ï¼Œå¯ä»¥åˆ›å»ºè½¯é“¾æŒ‡å‘åˆ°`.git/hooks`ï¼š
  ```sh
  find .git/hooks -type l -exec rm {} \; && find .githooks -type f -exec ln -sf ../../{} .git/hooks/ \;
  ```

4. æœ€åè®¾ç½®hookæ–‡ä»¶çš„å¯æ‰§è¡Œæƒé™è¿›è¡Œè„šæœ¬æ¿€æ´»ï¼š
```sh
chmod +x .githooks/post-checkout
```

## Husky
Huskyï¼ˆäºŒå“ˆ.pngï¼‰å¯ä»¥è‡ªåŠ¨é…ç½®githooksï¼Œä¸ªäººé¡¹ç›®é‡Œä½¿ç”¨Huskyä¼šå˜å¾—æ›´åŠ ä¾¿åˆ©ï¼Œå›¢é˜Ÿé‡Œä¹Ÿå¯ä»¥ä½¿ç”¨Huskyæ¥åšhookså…±äº«ã€‚webpackã€babelã€angularã€antdç­‰å¤§å‹å¼€æºé¡¹ç›®éƒ½ä½¿ç”¨äº†Huskyï¼Œè¿˜æ˜¯æ¯”è¾ƒå€¼å¾—ä¿¡èµ–çš„ã€‚ä¸æ”¾å¿ƒå¯ä»¥å»çœ‹ä¸‹æºç ï¼Œä»£ç å¾ˆçŸ­ä¹Ÿä¸å¤æ‚ã€‚

### è¯´æ˜
ä¸åŒç‰ˆæœ¬Huskyå·¥ä½œåŸç†ç•¥æœ‰ä¸åŒï¼Œå…¶ä¸­Husky 6å¯ä»¥ä½œä¸ºä¸€ä¸ªåˆ†æ°´å²­ã€‚æ‰€è°“ç”¨æ–°ä¸ç”¨æ—§å˜›ï¼Œå¦‚æœè€é¡¹ç›®é‡Œç”¨çš„è¿˜æ˜¯æ—§ç‰ˆï¼Œå¯ä»¥ä½¿ç”¨[husky-4-to-7](https://typicode.github.io/husky/#/?id=migrate-from-v4-to-v7)å·¥å…·å¿«é€Ÿè¿ç§»åˆ°æ–°ç‰ˆã€‚
- **åŸç†**ï¼šæ—§ç‰ˆæ˜¯ç›´æ¥ä¿®æ”¹`.git/hooks`ä¸­çš„è„šæœ¬ï¼ŒHusky 6åˆ™å¼€å§‹é‡‡ç”¨git 2.9çš„ç‰¹æ€§`core.hooksPath`æ¥æŒ‡å®šgithooksæ‰€åœ¨çš„ç›®å½•ï¼ŒåŒæ—¶ä¹Ÿè§£å†³äº†ä¸€äº›æ ¹æœ¬ä¸Šçš„é—®é¢˜ã€‚
- **ä½¿ç”¨æ–¹å¼**ï¼šæ—§ç‰ˆæ”¯æŒåœ¨`package.json`ä¸­é€šè¿‡`husky: {hooks: {"pre-commit": xxx} }`çš„æ–¹å¼æ¥æ›´æ–°è„šæœ¬ï¼Œè€Œæ–°ç‰ˆä»…æ”¯æŒä¿®æ”¹`.husky/`ç›®å½•ä¸‹çš„è„šæœ¬æ–‡ä»¶ã€‚


æ–°ç‰ˆHuskyä¸­æœ‰`npx husky-init`è¿™ä¸ªå…³é”®å‘½ä»¤ï¼Œé€šè¿‡å®ƒå°±èƒ½å¤§è‡´äº†è§£Huskyçš„å·¥ä½œåŸç†ï¼Œä¸‹é¢ä»¥npmä¸ºä¾‹ï¼š
- åˆ©ç”¨npxä¸´æ—¶ä¸‹è½½å¹¶è¿è¡Œ[`husky-init`](https://github.com/typicode/husky-init)è¿™ä¸ªä¾èµ–åŒ…ã€‚
  - è¯»å–`package.json`æ–‡ä»¶ï¼Œåœ¨`devDependencies`ä¸­æ·»åŠ `husky`åŒ…ï¼Œåœ¨scriptä¸­æ·»åŠ `"prepare": "husky install"`æŒ‡ä»¤ã€‚
  - åœ¨æ ¹ç›®å½•ç”Ÿæˆ`.husky`æ–‡ä»¶å¤¹ï¼Œä¹Ÿä¼šç”Ÿæˆä¸€ä¸ª`pre-commit`æ ·ä¾‹ã€‚
- å†å€ŸåŠ©`husky`ä¾èµ–åŒ…çš„`install`å®Œæˆï¼š
  - åœ¨æ ¹ç›®å½•çš„`.husky`ä¸­ç”Ÿæˆ`_`æ–‡ä»¶å¤¹ï¼Œå…¶ä¸­æœ‰å…³é”®çš„`husky.sh`æ–‡ä»¶ã€‚
  - æ‰§è¡Œ`config core.hooksPath .husky`ï¼ˆéœ€è¦git2.9ä»¥ä¸Šï¼‰ï¼Œå°†githooksç›®å½•æŒ‡å‘`.husky`ã€‚è‹¥gitç‰ˆæœ¬ä¸å¤Ÿï¼Œå»ºè®®å‡çº§ï¼Œè¦æ˜¯å®åœ¨å‡ä¸äº†ï¼Œå®‰è£…æ—§ç‰ˆhuskyã€‚


### å®‰è£…å’Œä½¿ç”¨
ç”±äºHuskyçš„åŠŸèƒ½ä¸ç¼–è¯‘æ— å…³ï¼Œéµå¾ª[â€œThe only valid use of install or preinstall scripts is for compilation which must be done on the target architectureâ€](https://docs.npmjs.com/cli/v7/using-npm/scripts#best-practices)ï¼ŒHuskyä¸å†æ”¯æŒè‡ªåŠ¨å®‰è£…ï¼Œæ‰€ä»¥è¿˜éœ€è¦åš`npm install husky`ä»¥å¤–çš„äº‹æƒ…ã€‚

å®Œæ•´æ•™ç¨‹è¯·çœ‹[å®˜æ–¹æ–‡æ¡£](https://typicode.github.io/husky/#/)ï¼Œä¾‹å¦‚å…³äºMonorepoã€ç¯å¢ƒå˜é‡ã€Git-flowç­‰ç­‰æ–‡æ¡£é‡Œéƒ½å†™çš„å¾ˆæ¸…æ¥šã€‚Yarnä½¿ç”¨huskyç¨å¾®æœ‰ç‚¹å¤æ‚ï¼Œä¸æ”¯æŒ`prepare`ï¼Œç§æœ‰ä»“åº“å…¬æœ‰ä»“åº“é…ç½®ä¹Ÿä¸åŒï¼Œç”¨Yarnçš„å°±ç›´æ¥çœ‹[å®˜ç½‘æ–‡æ¡£](https://typicode.github.io/husky/#/?id=yarn-2)å§ã€‚Npmä½¿ç”¨èµ·æ¥å°±æ¯”è¾ƒç®€å•ï¼Œæ‰€ä»¥ä¸‹é¢å°±åªä»npmçš„è§’åº¦ä»‹ç»ã€‚

1. é¦–æ¬¡å®‰è£…ç›´æ¥è¿è¡Œä»¥ä¸‹å¯¹åº”çš„å‘½ä»¤ï¼š
```bash
npx husky-init && npm install
```

2. å¦‚æœä¸æƒ³ä½¿ç”¨æ­¥éª¤ä¸€çš„è‡ªåŠ¨å®‰è£…ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©æ‰‹åŠ¨å®‰è£…ï¼Œç›¸å½“äºæ˜¯æ‹†åˆ†äº†`husky-init`ï¼Œåªéœ€åˆ†æ­¥æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š
```bash
npm install husky --save-dev
npx husky install
npm set-script prepare "husky install"
```
  å…¶ä¸­`npm set-script`éœ€è¦npm7ä»¥ä¸Šï¼Œå¦‚æœç‰ˆæœ¬è¿‡ä½ï¼Œå»ºè®®å‡çº§æˆ–è‡ªå·±æ‰‹åŠ¨å‘`package.json`æ·»åŠ ã€‚

3. æ·»åŠ hookï¼š
```bash
npx husky add .husky/commit-msg 'npx --no-install commitlint --edit "$1"'
```

4. å¦‚æœä¸æƒ³æ‰§è¡Œhookï¼Œå¯ä»¥åˆ©ç”¨HUSKYç¯å¢ƒå˜é‡ç»•è¿‡hookï¼š
```bash
HUSKY=0 git push
```

5. å¸è½½Huskyï¼š
```bash
npm uninstall husky && git config --unset core.hooksPath
```


## yorkie
[yorkie](https://github.com/yyx990803/yorkie)æ˜¯å°¤å¤§forkè‡ªhuskyï¼Œå¹¶å†…ç½®åˆ°äº†[Vue CLI](https://cli.vuejs.org/zh/guide/cli-service.html#git-hook)ï¼Œèƒ½åœ¨`package.json`çš„`gitHooks`å­—æ®µä¸­æ–¹ä¾¿åœ°æŒ‡å®šGit hookã€‚
yorkieå¯¹huskyå¹¶ä¸å…¼å®¹ï¼Œå®ƒå¯¹monorepoè¿›è¡Œäº†æ”¹è‰¯ï¼ŒåŒæ—¶ä¹Ÿä¿®æ”¹äº†é…ç½®å­—æ®µã€‚ä½†æ˜¯yorkieæœ€åä¸€æ¬¡æ›´æ–°æ˜¯18å¹´ğŸ¤·ğŸ»â€â™€ï¸åŸºæœ¬ä¸Šç®—æ˜¯åœæ­¢ç»´æŠ¤äº†ã€‚è€Œä¸”å®ƒforkçš„æ˜¯æ—§ç‰ˆhuskyï¼Œå³åŸç†ä»æ˜¯ç›´æ¥ä¿®æ”¹`.git/hooks`ä¸­çš„è„šæœ¬ã€‚è¿™æ—¶å€™å°±ä¼šé¢ä¸´yorkieå’ŒhuskyäºŒé€‰ä¸€ï¼Œå› ä¸ºåŒæ—¶ä½¿ç”¨ä¼šäº§ç”Ÿå†²çªï¼Œå¦‚æœyorkieå¤Ÿç”¨ï¼Œåˆ™ä¸éœ€è¦å†å®‰è£…huskyã€‚å¦‚æœæƒ³è¦æ–°åŠŸèƒ½æˆ–è€…å‘ç°äº†ä¸€äº›æ— æ³•è§£å†³çš„é—®é¢˜ï¼Œå¯ä»¥é€‰æ‹©huskyã€‚

```json
{
  "gitHooks": {
    "pre-commit": "lint-staged"
  },
   "lint-staged": {
    "*.{js,vue}": "vue-cli-service lint"
  }
}
```

## å°æŠ€å·§
- githooksæ”¯æŒshellã€Perlã€Rubyã€Pythonç­‰è„šæœ¬è¯­è¨€ï¼Œå¯ä»¥é€‰ç”¨ä»»æ„ä½ æ“…é•¿çš„ï¼Œç”šè‡³æ˜¯NodeJsã€‚
- å»ºè®®é˜…è¯»`.sample`åç¼€çš„å®˜ç½‘æ ·ä¾‹ï¼Œé‡Œé¢æœ‰hookåŸºæœ¬ä»‹ç»ã€å‚æ•°è¯´æ˜å’Œå®ç”¨ä»£ç ï¼Œéå¸¸å€¼å¾—å€Ÿé‰´ã€‚
- å¤§å¤šéƒ½æ˜¯ä½¿ç”¨hooksæ¥è¾…åŠ©å›¢é˜Ÿå†…çš„ç¼–ç è§„èŒƒå’Œcommitè§„èŒƒï¼Œæ­¤å¤–hooksè¿˜èƒ½åšæµç¨‹è§„èŒƒã€è‡ªåŠ¨éƒ¨ç½²ï¼ˆä¸å¤ªå¥½ç”¨ï¼‰ç­‰ç­‰ã€‚
- å¦‚æœæœ‰ä½¿ç”¨sourcetreeè¿™ç±»å·¥å…·ï¼Œhookså¯èƒ½ä¸ä¼šç”Ÿæ•ˆï¼Œä¸»è¦æ˜¯ç¯å¢ƒå˜é‡é—®é¢˜ï¼Œæ­¤æ—¶éœ€è¦åœ¨è„šæœ¬ä¸­æ·»åŠ `export PATH=/usr/local/bin:$PATH`ï¼Œæ¥ä¸´æ—¶æŒ‡å®šPATHç¯å¢ƒå˜é‡ã€‚


### è¾…åŠ©å·¥ç¨‹åŒ–
ç½‘ä¸Šæ•™ç¨‹å¾ˆå¤šï¼Œæ­¥éª¤ä¹ŸæŒºå¤šï¼Œæˆ‘å°±åªå†™ä¸€ä¸‹å¸¸è§çš„ç»„åˆå§ğŸ˜

- **ä»£ç è§„èŒƒ**ï¼š[husky](https://typicode.github.io/husky/) + [lint-staged](https://github.com/okonet/lint-staged) + [eslint](http://eslint.cn/) + [prettier](https://prettier.io/)
- **git commitè§„èŒƒ**ï¼š[husky](https://typicode.github.io/husky/) + [commitlint](https://commitlint.js.org/#/)

### hookæµ‹è¯•å’Œç¦ç”¨
exitå‘½ä»¤ä¸€èˆ¬ç”¨äºç»“æŸè„šæœ¬ï¼Œæ‰§è¡ŒæˆåŠŸä¼šè¿”å›0ï¼Œéé›¶é€€å‡ºåˆ™è¡¨ç¤ºè„šæœ¬æ‰§è¡Œå¤±è´¥ã€‚
æ‰€ä»¥ï¼Œè¦æµ‹è¯•hookå¯ä»¥åœ¨è„šæœ¬æœ«å°¾æ·»åŠ `exit 1`æ¥ä¸­æ­¢gitå‘½ä»¤ã€‚ç¦ç”¨ä¹Ÿä¸€æ ·ï¼Œä¾‹å¦‚æƒ³è¦ç¦ç”¨rebaseï¼Œå°±å¯ä»¥è¿™æ ·åˆ›å»º`pre-rebase`è„šæœ¬ï¼š
```sh
#!/bin/sh

# Disallow all rebasing
echo "pre-rebase: Rebasing is dangerous. Don't do it."
exit 1
```

### NodeJsè„šæœ¬æ ·ä¾‹ â€”â€” Husky
åˆ›å»º`.husky/post-checkout.js`æ–‡ä»¶ï¼Œå†™å…¥jsä»£ç ï¼š
```javascript
console.log(process.argv)
```

åˆ›å»ºpost-checkoutè„šæœ¬ï¼Œè°ƒç”¨jsæ–‡ä»¶ï¼ŒåŒæ—¶ä¼ å…¥å‚æ•°
```bash
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"
# æ”¯æŒ sourcetree
export PATH=/usr/local/bin:$PATH
node ./.husky/post-checkout.js $0 $1 $2 $3
```